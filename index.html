<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>360 VR Tour</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-stereo-component@^3.0.0/dist/aframe-stereo-component.min.js"></script>

  <style>
    html, body { height:100%; margin:0; background:#000; font-family: Arial, sans-serif; }
    .title { position:absolute; top:20px; width:100%; text-align:center; color:#fff; font-size:2rem; text-shadow:0 0 10px #00ffff; z-index:30; pointer-events:none; }
    .menu, .instruction-screen, .choice-screen { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; z-index:40; }
    .menu-card, .instruction-card, .choice-card {
      background:rgba(0,0,0,0.6); border:1px solid rgba(0,255,255,0.3);
      border-radius:12px; color:#fff; padding:24px; text-align:center;
      box-shadow:0 8px 24px rgba(0,0,0,0.6);
    }
    .btn {
      background:rgba(0,255,255,0.15); color:#fff;
      border:1px solid rgba(0,255,255,0.3); padding:10px 16px;
      border-radius:10px; cursor:pointer; font-weight:700; margin:6px;
      transition:0.2s;
    }
    .btn:hover { background:rgba(0,255,255,0.25); color:#000; }
    #playerContainer { position:absolute; inset:0; display:none; background:#000; z-index:1; }
    .top-ui { position:absolute; right:10px; top:10px; z-index:50; display:flex; gap:8px; }
    .ui-btn { background:rgba(255,255,255,0.1); color:#fff; border:1px solid rgba(255,255,255,0.2); padding:6px 10px; border-radius:8px; cursor:pointer; }
  </style>
</head>
<body>
  <div class="title">360 VR Tour</div>

  <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
  <div class="menu" id="mainMenu">
    <div class="menu-card">
      <div>Tilni tanlang / –í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫</div>
      <button class="btn" onclick="selectLang('ru')">üá∑üá∫ –†—É—Å</button>
      <button class="btn" onclick="selectLang('en')">üá¨üáß Eng</button>
      <button class="btn" onclick="selectLang('uz')">üá∫üáø O‚Äòz</button>
    </div>
  </div>

  <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è -->
  <div class="instruction-screen" id="instructionScreen" style="display:none;">
    <div class="instruction-card">
      <h3 id="instructionTitle">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h3>
      <p id="instructionText"></p>
      <div>
        <button class="btn" onclick="backToMenu()">‚óÄ –ù–∞–∑–∞–¥</button>
        <button class="btn" id="watchBtn" onclick="showChoice()">‚ñ∂ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å</button>
      </div>
    </div>
  </div>

  <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞: YouTube –∏–ª–∏ VR -->
  <div class="choice-screen" id="choiceScreen" style="display:none;">
    <div class="choice-card">
      <h3>–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</h3>
      <p>–ú–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –≤–∏–¥–µ–æ –ø—Ä—è–º–æ –Ω–∞ YouTube –∏–ª–∏ –≤–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º VR-–ø–ª–µ–µ—Ä–µ.</p>
      <div>
        <button class="btn" onclick="openYouTube()">üì∫ –°–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ YouTube</button>
        <button class="btn" onclick="openPlayer()">üï∂ –°–º–æ—Ç—Ä–µ—Ç—å –≤ VR-–ø–ª–µ–µ—Ä–µ</button>
      </div>
      <div style="margin-top:10px;">
        <button class="btn" onclick="backToInstruction()">‚óÄ –ù–∞–∑–∞–¥</button>
      </div>
    </div>
  </div>

  <!-- VR-–ø–ª–µ–µ—Ä -->
  <div id="playerContainer">
    <div class="top-ui">
      <button class="ui-btn" onclick="toggleMute()" id="muteBtn">üîà Mute</button>
      <button class="ui-btn" onclick="enterCardboard()">üì± VR</button>
      <button class="ui-btn" onclick="exitPlayer()">‚úï</button>
    </div>

    <a-scene id="aframeScene" embedded vr-mode-ui="enabled: true" background="color:#000" renderer="antialias:true;">
      <a-assets>
        <video id="vrVideo" src="https://files.catbox.moe/hqn35y.mp4" crossorigin="anonymous" playsinline webkit-playsinline preload="auto"></video>
      </a-assets>

      <a-entity id="cameraRig">
        <a-entity id="camera" camera look-controls="touchEnabled:true; enabled:true;" position="0 1.6 0"></a-entity>
      </a-entity>

      <a-videosphere id="videoSphere" src="#vrVideo" rotation="0 -90 0"></a-videosphere>
    </a-scene>
  </div>

  <script>
    const texts = {
      ru: {
        title: "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è",
        instr: "–ü–æ–≤–æ—Ä–∞—á–∏–≤–∞–π—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ –¥–≤–∏–≥–∞–π—Ç–µ –ø–∞–ª—å—Ü–µ–º –ø–æ —ç–∫—Ä–∞–Ω—É, —á—Ç–æ–±—ã –æ—Å–º–æ—Ç—Ä–µ—Ç—å—Å—è. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ¬´VR¬ª –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Ä–µ–∂–∏–º Cardboard.",
        watch: "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å"
      },
      en: {
        title: "Instructions",
        instr: "Move your phone or drag the screen to look around. Tap the 'VR' button to enter Cardboard mode.",
        watch: "Watch"
      },
      uz: {
        title: "Ko‚Äòrsatmalar",
        instr: "Telefonni aylantiring yoki barmog‚Äòingiz bilan ekran bo‚Äòylab aylantiring. 'VR' tugmasini bosing ‚Äì Cardboard rejimiga o‚Äòtish uchun.",
        watch: "Ko‚Äòrish"
      }
    };

    let currentLang = 'ru';

    function selectLang(lang){
      currentLang = lang;
      document.getElementById('instructionTitle').innerText = texts[lang].title;
      document.getElementById('instructionText').innerText = texts[lang].instr;
      document.getElementById('watchBtn').innerText = texts[lang].watch;
      document.getElementById('mainMenu').style.display = 'none';
      document.getElementById('instructionScreen').style.display = 'flex';
    }

    function backToMenu(){
      document.getElementById('instructionScreen').style.display = 'none';
      document.getElementById('mainMenu').style.display = 'flex';
    }

    function showChoice(){
      document.getElementById('instructionScreen').style.display = 'none';
      document.getElementById('choiceScreen').style.display = 'flex';
    }

    function backToInstruction(){
      document.getElementById('choiceScreen').style.display = 'none';
      document.getElementById('instructionScreen').style.display = 'flex';
    }

    function openYouTube(){
      window.open("https://www.youtube.com/watch?v=6WX-oVWf5YY", "_blank");
    }

    async function openPlayer(){
      document.getElementById('choiceScreen').style.display = 'none';
      document.getElementById('playerContainer').style.display = 'block';

      const vrVideo = document.getElementById('vrVideo');
      vrVideo.loop = true;
      vrVideo.muted = false;
      vrVideo.currentTime = 0;
      try {
        await vrVideo.play();
      } catch(e){
        console.warn('Autoplay blocked, showing controls');
        vrVideo.setAttribute('controls', 'true');
      }

      const cam = document.getElementById('camera');
      cam.setAttribute('look-controls', 'touchEnabled:true; magicWindowTrackingEnabled:true; enabled:true');
    }

    function exitPlayer(){
      const vid = document.getElementById('vrVideo');
      vid.pause();
      document.getElementById('playerContainer').style.display = 'none';
      document.getElementById('mainMenu').style.display = 'flex';
    }

    function enterCardboard(){
      const scene = document.querySelector('a-scene');
      if (scene) scene.enterVR();
    }

    function toggleMute(){
      const vid = document.getElementById('vrVideo');
      vid.muted = !vid.muted;
      document.getElementById('muteBtn').innerText = vid.muted ? 'üîá Muted' : 'üîà Unmuted';
    }
  </script>
</body>
</html>
